{{/*
  Client Logos partial
  Usage examples:
  - From a template where the page has Params.client_logos:
      {{ with .Params.client_logos }}{{ partial "client-logos.html" . }}{{ end }}
  - Or pass a dict to control title/animate:
      {{ partial "client-logos.html" (dict "logos" .Params.client_logos "title" "Trusted by ..." "animate" "true") }}
  Notes:
  - The root context $ still points to the calling page, so we can access $.Site/$.Params even if . is a slice.
*/}}

{{ $title := site.Params.text.trustedByCompanies }}
{{ $animate := "false" }}
{{ $logos := slice }}

{{/* Determine logos source */}}
{{ if . }}
  {{ if (reflect.IsSlice .) }}
    {{ $logos = . }}
  {{ else }}
    {{ with .logos }}{{ $logos = . }}{{ end }}
    {{ with .title }}{{ $title = . }}{{ end }}
    {{ with .animate }}{{ $animate = . }}{{ end }}
  {{ end }}
{{ end }}
{{ if not $logos }}
  {{ with $.Params.client_logos }}{{ $logos = . }}{{ end }}
{{ end }}

<section class="border-y bg-gray-50 overflow-hidden">
  <div class="container mx-auto">
    <div class="py-12">
      <p class="text-center text-3xl md:text-2xl font-bold mb-6">{{ $title }}</p>
      {{ if eq $animate "false" }}
        <div class="logo-scroll static">
          <div class="logos-slide">
            {{ range $logos }}
              <img src="{{ .logo | relURL }}" class="h-20" alt="{{ .name }}" />
            {{ end }}
          </div>
        </div>
      {{ else }}
        <div class="logo-scroll">
          <div class="logos-slide animate">
            {{ range $logos }}
              <img src="{{ .logo | relURL }}" class="h-20" alt="{{ .name }}" />
            {{ end }}
          </div>
        </div>
      {{ end }}
    </div>
  </div>
</section>

<style>
.logo-scroll {
    overflow: hidden;
    padding: 20px 0;
    white-space: nowrap;
    position: relative;
}

.logo-scroll.static {
    display: flex;
    justify-content: center;
    overflow: visible;
}

.logo-scroll.static .logos-slide {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 40px;
}

.logos-slide {
    display: inline-block;
}

.logos-slide.animate {
    animation: 30s slide infinite linear;
}

.logos-slide img {
    max-height: 5rem;
    margin: 0 40px;
    display: inline-block;
    vertical-align: middle;
}

.logo-scroll.static .logos-slide img {
    margin: 0;
}

@keyframes slide {
    from {
        transform: translateX(0);
    }
    to {
        transform: translateX(calc(-100% / 2));
    }
}

.logo-scroll:hover .logos-slide.animate {
    animation-play-state: paused;
}

/* Mobile-specific animation speed */
@media (max-width: 768px) {
    .logos-slide.animate {
        animation: 15s slide infinite linear;
    }
}
</style>
